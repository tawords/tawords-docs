# 背Ta单词 安装升级向导 接口Api



（X）假设现在本地是1.0.0开发版本，服务端是1.1.0正式版本



【版本号格式】一键安装程序版本号(x) 更新程序版本号(x) 网站版本号(x.x.x) 数据库版本号(x)

网站版本分支分为

| 开发版  | 预览版 | 内测版 | 最终测试版 | 正式版 |
| ------- | ------ | ------ | ---------- | ------ |
| develop | alpha  | beta   | rc         | stable |

------

## 升级流程

以下所有操作，请求地址均为：https://api.tawords.com/v1/update.php

**请注意，参数名及参数值请使用小写，否则可能返回错误。**

### 1. 检查更新程序是否需要更新

本地向服务端发送GET请求，判断更新程序是否需要更新

请求参数列表

| 参数     | 类型   | 是否必填 | 可选值                | 说明                                         |
| -------- | ------ | -------- | --------------------- | -------------------------------------------- |
| platform | string | 否       | 【预留字段无需填写】  | 指明当前发起请求的平台，后期可能加入其他端。 |
| action   | string | 是       | check_updater_version |                                              |

例如：https://api.tawords.com/v1/update.php?action=check_updater_version

**返回结果**

返回最新版本updater信息（新版版本号，url地址，是否被压缩，哈希值MD5），请本地自行判断更新程序是否需要更新



### 2. 获取最新版本信息

本地向服务端发送GET请求，获取最新版本信息以及下载地址

请求参数列表

| 参数     | 类型   | 是否必填 | 可选值                                  | 说明                                                         |
| -------- | ------ | -------- | --------------------------------------- | ------------------------------------------------------------ |
| platform | string | 否       | 【预留字段无需填写】                    | 指明当前发起请求的平台，后期可能加入其他端。                 |
| action   | string | 是       | get_info                                |                                                              |
| dist     | string | 是       | develop(或dev)、alpha、beta、rc、stable | dist是distribution的缩写，指的是本地是哪个版本分支。<br />开发版为develop或dev，预览版alpha，内测版为beta，最终测试版为rc（release candidate的缩写），正式版为stable。 |
| type     | string | 是       | update、initial                         | 类型，是初次安装、还是更新。<br />初次安装为initial，更新为update |
| version  | string | 否       | <当前版本号，如1.0.0>                   | 只包含数字(0-9)和小数点(.)，不包含其他任何字符，格式：x.x.x（如：1.2.10）。<br /><br />如果该参数不传或传入为空，将返回当前所有版本的更新信息。<br /><br />传入正确版本号将返回当前版本适用的所有可更新版本信息，没有可更新版本将返回。<br />传入其他格式将返回错误 |

例如：https://api.tawords.com/v1/update.php?action=getinfo&dist=develop&type=update&version=1.0.0

返回JSON格式

**有更新时**

更新版本分支

适合更新的所有版本信息（新版版本号、更新说明、重要提示（可选，如果有请务必醒目提示用户该信息）、更新包下载地址（备用下载地址），更新包哈希值MD5）

获取之后，进行更新操作。

**无更新时**

返回”已经是最新版本“

**请求错误时**

返回错误信息



2. 